# REST APIとは

REST APIは6つの設計規約に準じてWebサービスで提供している機能やデータを外からプログラムが読み取りやすい形で利用できるように定めた規約

## RESTfulとは
RESTで求められている原則に従っていること　

### RESTとは
**RE**presentational **S**tate **T**ransfer

分散型システムにおける**設計原則群**(設計ルール)

1. nullスタート
2. クライアント/サーバー
3. ステートレス
4. キャッシュ制御
5. 統一インターフェイス
6. 階層化システム
7. コードオンデマンド

<details>
<summary>クライアント/サーバー</summary>

1. 画面(UI)とデータで関心事を分離
2. クライアント側がトリガー、サーバー側は受け身

</details>

<details>
<summary>階層化システム</summary>

- メリット

各システム(コンポーネント)に役割を決めて独立させることで、進化と再利用が促進できる

- デメリット

データ処理にオーバーヘッドが発生

ユーザーから見ると応答が悪く見える

 **キャッシュを利用すると改善が見込める**

</details>

<details>
<summary>コードオンデマンド</summary>

クライアントコードをダウンロードして実行できる

**リリース後にクライアントコードを変更できる**

i.e. HTMLの更新

- メリット

リリース済みのクライアントに対して機能追加ができる

サーバーの負荷が下がる (クライアントに処理が移譲できるため)

- デメリット

評価環境が複雑になる

</details>

<details>
<summary>統一インターフェイス</summary>

4つの規約

1. リソースの識別

URIを用いてサーバーに保存されたデータを識別する

**URIはリソースを識別するもので動作は含まない**
2. 表現を用いたリソース操作

クライアントからサーバーへ編集リクエストをする際に、認証情報などの追加情報を付与する。

i.e Bearer Token

3. 自己記述メッセージ

メッセージ内容が何であるかヘッダーに記述されている

レスポンスに含まれるメタデータ(ヘッダー情報)で内容がわかる

4. アプリケーション状態エンジンとしてのハイパーメディア (HATEOAS)

レスポンスに現在の状態を踏まえて関連するハイパーリンクが含まれている

i.e. 検索結果ページにおける次のページ
</details>

<details>
<summary>ステートレス</summary>
サーバーはリクエストだけでコンテキストを理解できる

- サーバーは保存されたコンテキスト情報は使わない (サーバーセッションは使わない)

- 状態はクライアント上に保存される (リクエストに全て含める)

リクエストに状態情報が含まれるためリクエストが独立する

</details>

<details>
<summary>キャッシュ制御</summary>
クライアントはレスポンスをキャッシュできる

- レスポンスは明示的にまたは暗黙的にキャッシュ可能
- キャッシュを適切に行うことでクライアント/サーバー間の通信が排除されユーザー体験の向上、リソース効率の向上、拡張性の向上が見込める

</details>

## REST API設計レベル

### Level 0. HTTPの使用
RPCスタイルのXML通信
  - HTTPは単なる通信手段
  - 1 URLで全て完結
  - Request Bodyに処理と引数が含まれる
### Level 1. リソースの概念を導入
  - リソースごとにURLを分離
  - HTTPメソッドは活用できないので、GETかPOSTのみ
### Level 2. HTTPの動詞を導入
  - HTTPメソッドを使ったCRUD操作が行われる

| 操作 | CRUD | HTTPメソッド |
| ----------- | ----------- | ------------ |
| 登録 | Create | POST, PUT |
| 取得 | Read | GET |
| 更新 | Update | PUT |
| 削除 | Delete | DELETE |

### Level 3. HATEOASの概念の導入

レスポンスにリソース間のつながりが含まれる

  - レスポンスに現在の状態に関するハイパーリンクが含まれている

## Web APIとは
> HTTPなどの技術を利用して**プログラムが読み書きしやすい**
> 形でメッセージ送受信を行えるように定義した
> **規約**,または規約を実装して展開されるサービス

つまりWebサービスで提供している機能やデータを外からプログラムが読み取りやすい形で利用できるように定めた規約、またはその実装

## URIの設計

- 冗長なパスを含まない
- 省略しない
- 全て小文字
- 単語はハイフンで繋げる
- 単語は複数形
- エンコードを必要とする文字を使用しない
- サーバー側のアーキテクチャが反映されていない
- 改造しやすい
- ルールが統一されている

## ステータスコード

| ステータスコード | 意味 |
| ----------- | ----------- |
| 100番台 | 情報 |
| 200番台 | 成功 |
| 300番台 | リダイレクト |
| 400番台 | クライアントサイドに起因するエラー |
| 500番台 | サーバーサイドに起因するエラー |

## 100番台

| 種類 | 説明 |
| ----------- | ----------- |
| 100 Continue | サーバーがリクエストの最初の部分を受け取り、まだサーバーから拒否されていない |
| 101 Switching Protocol | プロトコルの切り替え要求 |

## 200番台

| 種類 | 説明 |
| ----------- | ----------- |
| 200 OK | リクエストが成功したことを示す。<br>本文にデータが含まれる。 |
| 201 Created | リクエストが成功し、新しいリソースが作成されたことを示す。<br>ヘッダーのLocationに新しいリソースへのURLを含める。 |
| 202 Accepted | 非同期ジョブを受け付けたことを示す。<br>実際の処理結果は別途受け取る。 |
| 204 No Content | リクエストは成功したが、レスポンスデータが無いことを示す。<br>クライアント側のビューを変更する必要が無いことを意味する。 |
